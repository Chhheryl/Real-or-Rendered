<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{ lesson.title }}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='css/style.css') }}"
      rel="stylesheet"
    />
  </head>
  <body class="p-4">

    <!-- Top nav: Real or Rendered? / Home / Gallery / Quiz -->
    <nav class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
      <span class="h4 mb-0">Real or Rendered?</span>
      <ul class="nav">
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('home') }}">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="{{ url_for('transition') }}">Gallery</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('quiz', question_id=1) }}">Quiz</a>
        </li>
      </ul>
    </nav>

    <div class="d-flex justify-content-between align-items-center mb-3">
      <div class="text-muted">
        <strong>üîì You‚Äôve unlocked: {{ unlocked }} / {{ lessons|length }} cues</strong>
      </div>
    </div>

    <!-- Section subtitle -->

    <h2>{{ lesson.title }}</h2>
    <p class="text-muted">{{ lesson.tip }}</p>

    <div class="row my-4">
      <div class="col-md-6">
        <h5>AI-generated artwork</h5>
        <div class="image-container">
          <img
            src="{{ url_for('static', filename='images/' + lesson.images.ai) }}"
            class="img-fluid"
            id="ai-image"
            height="300"
          />
          {% for spot in lesson.hotspots %}
          <div
            class="hotspot"
            style="top: {{ spot.y_pct }}%; left: {{ spot.x_pct }}%;"
            data-label="{{ spot.label }}"
            data-zoom-ai="{{ url_for('static', filename='images/' + spot.zoom_ai) }}"
            data-zoom-real="{{ url_for('static', filename='images/' + spot.zoom_real) }}"
            data-explanation="{{ spot.explanation }}"
          >
            {{ spot.id }}
          </div>
          {% endfor %}
        </div>
      </div>
      <div class="col-md-6">
        <h5>Human-made artwork</h5>
        <img
          src="{{ url_for('static', filename='images/' + lesson.images.real) }}"
          class="img-fluid"
          height="300"
        />
      </div>
    </div>

    {% if lesson.quick_tip %}
    <!-- Quick tip block -->
    <div class="mb-4">
      <strong>üí° Quick tip:</strong> {{ lesson.quick_tip }}
    </div>
    {% endif %}

    <!-- Modal for Zoom -->
    <div class="modal fade" id="zoomModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="modal-header">
            <h5 class="modal-title">Hotspot Details</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <p id="modal-explanation"></p>
            <div class="row">
              <div class="col-md-6 text-center">
                <h6>AI</h6>
                <img id="modal-ai" class="img-fluid" />
              </div>
              <div class="col-md-6 text-center">
                <h6>Human</h6>
                <img id="modal-real" class="img-fluid" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bottom navigation -->
    <div class="d-flex justify-content-between flex-wrap mt-5 gap-2">
      <div class="d-flex justify-content-center flex-wrap gap-2 mx-auto">
        <a href="{{ url_for('transition') }}" class="btn btn-outline-secondary">
          ‚Üê Back to Topics
        </a>
        <a href="{{ url_for('home') }}" class="btn btn-outline-dark">üè† Home</a>
        <a
          href="{{ url_for('quiz', question_id=1) }}"
          class="btn btn-outline-success"
        >
          üéÆ Go to Quiz
        </a>
      </div>
      <div class="d-flex gap-2">
        {% if prev_id %}
        <a
          href="{{ url_for('learn', lesson_id=prev_id) }}"
          class="btn btn-outline-secondary"
        >
          ‚Üê Previous: {{ lessons[prev_id - 1].title }}
        </a>
        {% endif %}
        {% if next_id %}
        <a
          href="{{ url_for('learn', lesson_id=next_id) }}"
          class="btn btn-primary"
        >
          Next: {{ lessons[next_id - 1].title }} ‚Üí
        </a>
        {% else %}
        <a
          href="{{ url_for('quiz', question_id=1) }}"
          class="btn btn-success"
        >
          Start the Quiz ‚Üí
        </a>
        {% endif %}
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.querySelectorAll(".hotspot").forEach((spot) => {
        spot.addEventListener("click", () => {
          const aiImg = spot.getAttribute("data-zoom-ai");
          const realImg = spot.getAttribute("data-zoom-real");
          const explanation = spot.getAttribute("data-explanation");

          document.getElementById("modal-ai").src = aiImg;
          document.getElementById("modal-real").src = realImg;
          document.getElementById("modal-explanation").textContent =
            explanation;

          new bootstrap.Modal(document.getElementById("zoomModal")).show();
        });
      });
    </script>
  </body>
</html>
